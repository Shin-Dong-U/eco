<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.goott.eco.mapper.OrderMapper">
	
	<select id="selectOrdderMainNum">
		select seq_order_seq.currval from dual
	</select>
	<insert id="addOrderMain">
		insert into eco.order_main values(seq_order_seq.nextval,#{custId},default,default,#{custId},'','','','')	
	</insert>
	<insert id="addOrderDetail">
		<selectKey keyProperty="order_seq" order="BEFORE" resultType="long">
			select seq_order_seq.currval from dual
		</selectKey>
		insert into eco.order_detail values(order_seq,seq_order_detail_seq.nextval,#{custId},#{basketNum},default,#{custId},'','')
	</insert>
	
	
	<select id="getBasketList" resultType="com.goott.eco.domain.BasketVO">
		SELECT * FROM eco.basket WHERE cust_id=#{custId} AND delete_yn='N'
	</select>
	
	<select id="getGoodsInfo" resultType="com.goott.eco.domain.GoodsVOtest">
		SELECT * FROM eco.goods WHERE goods_seq=#{goodsSeq}
	</select>
	
	<update id="delGoodsAtBasket">
		UPDATE eco.basket SET delete_yn='Y' WHERE cust_id=#{custId} AND goods_seq=#{goodsSeq}
	</update>
	
	<update id="purGoodsAtBasket">
		UPDATE eco.basket SET purchase_yn='Y' WHERE cust_id=#{custId} AND goods_seq=#{goodsSeq}
	</update>
	
	<insert id="addGoodsAtBasket">
		INSERT into eco.basket values(seq_basket_seq.nextval,#{goodsSeq},#{custId},#{qty},default,default,default,#{custId},'','')
	</insert>
	
	<update id="changeQtyAtBasket">
		UPDATE eco.basket SET qty=#{qty} WHERE cust_id=#{custId} AND goods_seq=#{goodsSeq}
	</update>

</mapper>