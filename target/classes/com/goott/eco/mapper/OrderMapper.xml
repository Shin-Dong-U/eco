<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.goott.eco.mapper.OrderMapper">
	
	
	<!-- <select id="getOrderNum" resultType="Long">
		select seq_temp_orderNum.nextval from dual
	</select> 
	

	<select id="getGoodsNumList" resultType="com.goott.eco.domain.GoodsVOtest">
		SELECT *FROM GOODS
		WHERE GOODS_SEQ IN (
			SELECT GOODS_SEQ FROM ORDER_DETAIL 
			WHERE order_seq =(SELECT order_seq 
		  		FROM order_main 
		  		where cust_id={cust_id} and order_status=0))
	</select> -->
	
	<!--주문하기  시작 -->
	<insert id="addOrderMain">
		INSERT INTO eco.order_main values(seq_order_seq.nextval,#{cust_id},default,default,'',default,#{cust_id},'','')
	</insert>
	<select id="getOrderSeq" resultType="Long">
		select order_seq from order_main where cust_id=#{cust_id} and order_status=0
	</select>
	<insert id="addOrderDetail">
		INSERT INTO eco.order_detail values(#{order_seq},#{basket_seq},#{goods_seq},default,#{cust_id},'','')
	</insert>
	<update id="upOrderStatus">
		UPDATE  eco.order_main SET ORDER_STATUS = 1 WHERE order_seq = #{order_seq}
	</update>
	<!--주문하기  끝 -->
	
	<!--주문리스트  -->
	<select id="getOrderList" resultType="com.goott.eco.domain.GoodsVOtest">
	<![CDATA[	
		SELECT *FROM GOODS
		WHERE GOODS_SEQ IN (
			SELECT GOODS_SEQ FROM ORDER_DETAIL 
			WHERE order_seq =(SELECT order_seq 
		  		FROM order_main 
		  		where cust_id=#{cust_id}))
	]]>
	</select>
	
	

</mapper>